# 什么是机器学习项目中的数据准备

> 原文：<https://machinelearningmastery.com/what-is-data-preparation-in-machine-learning/>

最后更新于 2020 年 6 月 30 日

数据准备可能是任何机器学习项目中最困难的步骤之一。

原因是每个数据集都是不同的，并且高度特定于项目。然而，跨预测建模项目有足够多的共性，我们可以定义您可能执行的一系列松散的步骤和子任务。

这个过程提供了一个背景，我们可以在其中考虑项目所需的数据准备，由数据准备之前执行的项目定义和之后执行的机器学习算法的评估来提供信息。

在本教程中，您将发现如何将数据准备视为更广泛的预测建模机器学习项目的一个步骤。

完成本教程后，您将知道:

*   每个带有机器学习的预测建模项目都是不同的，但是每个项目都有共同的步骤。
*   数据准备包括最好地将问题的未知底层结构暴露给学习算法。
*   项目中数据准备之前和之后的步骤可以告知应用或者至少探索哪些数据准备方法。

**用我的新书[机器学习的数据准备](https://machinelearningmastery.com/data-preparation-for-machine-learning/)启动你的项目**，包括*分步教程*和所有示例的 *Python 源代码*文件。

我们开始吧。

![What Is Data Preparation in a Machine Learning Project](img/1c504d205fdf41751273b9e034ba3293.png)

什么是机器学习项目中的数据准备
图片由 [dashll](https://flickr.com/photos/73270593@N03/6612304687/) 提供，保留部分权利。

## 教程概述

本教程分为三个部分；它们是:

1.  应用机器学习过程
2.  什么是数据准备
3.  如何选择数据准备技术

## 应用机器学习过程

每个机器学习项目都是不同的，因为项目核心的具体数据是不同的。

你可能是第一个人(有史以来！)来处理特定的预测建模问题。这并不意味着其他人没有从事过类似的预测任务，甚至可能没有从事过相同的高级任务，但是您是第一个使用您收集的特定数据的人(除非您正在使用标准数据集进行练习)。

> ……正确的特征只能在模型和数据的上下文中定义；因为数据和模型是如此的多样化，所以很难在项目间推广特性工程的实践。

—第七页，[机器学习的特征工程](https://amzn.to/3b9tp3s)，2018。

这使得每个机器学习项目都是独一无二的。没有人能告诉你最好的结果是什么或可能是什么，或者用什么算法来实现它们。您必须建立一个表现基线作为比较所有模型的参考点，并且您必须发现什么算法最适合您的特定数据集。

你并不孤单，之前关于应用机器学习的大量文献可以告诉你如何使用技术来稳健地评估你的模型和算法。

即使你的项目是独一无二的，通往好的甚至最好的结果的道路上的步骤在不同的项目中通常是相同的。这有时被称为“*应用机器学习过程*”、“*数据科学过程*”，或更老的名称“*数据库中的知识发现*”(KDD)。

应用机器学习的过程由一系列步骤组成。步骤是相同的，但是执行的步骤和任务的名称可能因描述而异。

此外，这些步骤是按顺序编写的，但是对于任何给定的项目，我们将在这些步骤之间来回跳转。

我喜欢使用四个高级步骤来定义流程:

*   **第一步**:定义问题。
*   **第二步**:准备数据。
*   **第三步**:评估模型。
*   **第四步**:定型。

让我们仔细看看这些步骤。

### 步骤 1:定义问题

这一步涉及对项目的足够了解，以选择预测任务的框架或框架。比如是分类还是回归，或者其他一些高阶问题类型？

它包括收集被认为有助于做出预测的数据，并明确定义预测将采取的形式。它还可能涉及到与项目涉众和其他在该领域具有深厚专业知识的人交谈。

这一步还包括仔细查看数据，以及可能使用汇总统计和数据可视化来探索数据。

### 第二步:准备数据

这一步涉及将收集的原始数据转换成可用于建模的形式。

> 数据预处理技术通常指训练集数据的添加、删除或转换。

—第 27 页，[应用预测建模](https://amzn.to/3b2LHTL)，2013 年。

我们将在下一节中更详细地了解这一步骤。

### 步骤 3:评估模型

这一步涉及评估数据集上的机器学习模型。

它要求您设计一个健壮的测试工具来评估您的模型，以便您得到的结果可以被信任，并用于在您已经评估的模型中进行选择。

这包括选择评估模型技能的表现指标、建立所有模型评估可与之比较的表现基线或下限，以及将数据拆分为训练集和测试集以模拟如何使用最终模型的重采样技术等任务。

对于模型表现的快速和肮脏的估计，或者对于非常大的数据集，可以执行数据的单个训练测试分割。更常见的是使用 k 倍交叉验证作为数据重采样技术，通常重复该过程以提高结果的鲁棒性。

这一步还包括从表现良好的模型中获得最大收益的任务，如超参数调整和模型集成。

### 步骤 4:最终确定模型

这一步涉及选择和使用最终模型。

一旦评估了一套模型，您必须选择一个代表项目“*解决方案*”的模型。这被称为[模型选择](https://machinelearningmastery.com/a-gentle-introduction-to-model-selection-for-machine-learning/)，可能涉及在等待验证数据集上进一步评估候选模型，或者通过其他特定于项目的标准(如模型复杂性)进行选择。

它还可能包括以标准的方式为项目涉众总结模型的表现，这是一个重要的步骤。

最后，可能会有与模型的[产品化相关的任务，例如将其集成到软件项目或生产系统中，并为模型设计监控和维护计划。](https://machinelearningmastery.com/deploy-machine-learning-model-to-production/)

现在我们已经熟悉了应用机器学习的过程，以及数据准备在该过程中的位置，让我们更仔细地看看可能执行的任务类型。

## 什么是数据准备

在预测建模项目中，例如分类或回归，原始数据通常不能直接使用。

这是因为以下原因:

*   机器学习算法要求数据是数字。
*   一些机器学习算法对数据提出了要求。
*   数据中的统计噪声和误差可能需要纠正。
*   复杂的非线性关系可以从数据中梳理出来。

因此，原始数据必须在用于拟合和评估机器学习模型之前进行预处理。预测建模项目中的这一步被称为“**数据准备**，尽管它还有许多其他名称，如“*数据扯皮*”、“*数据清理*”、“*数据预处理*”和“*特征工程*”。其中一些名称可能更适合作为更广泛的数据准备过程的子任务。

我们可以将数据准备定义为将原始数据转换为更适合建模的形式。

> 数据扯皮，也就是通常所说的数据蒙骗、转换、操纵、看门人工作等。，可能是一个煞费苦心费力的过程。

—第五页，[与 R](https://amzn.to/2z8NB8k) 的数据角力，2016。

这对于您的数据、项目的目标以及用于建模数据的算法来说是非常具体的。我们将在下一节中更多地讨论这些关系。

然而，在机器学习项目的数据准备步骤中，您可能会使用或探索一些常见或标准的任务。

这些任务包括:

*   **数据清理**:识别并纠正数据中的错误或差错。
*   **特征选择**:识别那些与任务最相关的输入变量。
*   **数据转换**:改变变量的规模或分布。
*   **特征工程**:从可用数据中导出新变量。
*   **降维**:创建数据的紧凑投影。

这些任务中的每一项都是具有专门算法的整个研究领域。

数据准备不是盲目进行的。

在某些情况下，在我们应用机器学习算法之前，必须对变量进行编码或转换，例如将字符串转换为数字。在其他情况下，就不那么清楚了，比如缩放变量对算法可能有用，也可能没用。

数据准备的更广泛的哲学是发现如何最好地将问题的底层结构暴露给学习算法。**这是引导光**。

我们不知道问题的潜在结构；如果我们这样做了，我们就不需要学习算法来发现它，并学习如何做出巧妙的预测。因此，揭示问题的未知底层结构是一个发现的过程，同时发现项目中表现良好或最好的学习算法。

> 然而，我们经常不知道改善模型表现的预测因子的最佳再现。相反，预测器的重新工作更像是一门艺术，需要正确的工具和经验来找到更好的预测器表示。此外，我们可能需要搜索许多替代的预测器表示来提高模型表现。

—第十二页，[特征工程与选择](https://amzn.to/2Wu7zlL)，2019 年。

它可能比乍看起来更复杂。例如，不同的输入变量可能需要不同的数据准备方法。此外，不同的变量或输入变量子集可能需要不同的数据准备方法序列。

考虑到大量的方法，每种方法可能都有自己的配置和要求，这可能会让人感到难以承受。尽管如此，数据准备前后的机器学习过程步骤可以帮助告知需要考虑哪些技术。

## 如何选择数据准备技术

我们如何知道在数据中使用什么数据准备技术？

> 如同许多统计学问题一样，“哪个特征工程方法是最好的？”视情况而定。具体来说，这取决于所使用的模型以及与结果的真实关系。

—第 28 页，[应用预测建模](https://amzn.to/3b2LHTL)，2013 年。

从表面上看，这是一个具有挑战性的问题，但如果我们在整个项目的背景下看数据准备步骤，它会变得更加简单。预测建模项目中数据准备步骤前后的步骤通知可能需要的数据准备。

数据准备之前的步骤包括定义问题。

作为定义问题的一部分，这可能涉及许多子任务，例如:

*   从问题领域收集数据。
*   与主题专家讨论项目。
*   选择这些变量作为预测模型的输入和输出。
*   查看已收集的数据。
*   使用统计方法总结收集的数据。
*   使用图表将收集的数据可视化。

关于数据的已知信息可用于选择和配置数据准备方法。

例如，数据图可以帮助识别变量是否有异常值。这有助于数据清理操作。它还可以提供对数据背后的概率分布的洞察。这可能有助于确定改变变量概率分布的数据转换是否合适。

统计方法(如描述性统计)可用于确定是否需要缩放操作。统计假设检验可以用来确定一个变量是否符合给定的概率分布。

成对图和统计数据可用于确定变量是否相关，如果相关，则确定多少，从而提供一个或多个变量是否冗余或与目标变量无关的洞察。

因此，问题的定义和数据的准备之间可能有很多相互作用。

数据准备步骤和模型评估之间也可能存在相互作用。

模型评估可能涉及子任务，例如:

*   选择评估模型预测技能的表现指标。
*   选择模型评估程序。
*   选择要评估的算法。
*   调整算法超参数。
*   将预测模型组合成整体。

关于算法选择和发现表现良好的算法的已知信息也可以为数据准备方法的选择和配置提供信息。

例如，算法的选择可能会对数据中输入变量的类型和形式提出要求和期望。这可能需要变量具有特定的概率分布，移除相关的输入变量，和/或移除与目标变量没有强相关性的变量。

表现度量的选择也可能需要仔细准备目标变量以满足预期，例如使用特定的度量单位基于预测误差对回归模型进行评分，需要对应用于该变量的任何缩放变换进行反演以进行建模。

这些例子以及更多的例子强调，尽管数据准备是预测建模项目中的一个重要步骤，但它并不是孤立的。相反，它受到数据准备前后执行的任务的强烈影响。这突出了任何预测建模项目的高度迭代性。

## 进一步阅读

如果您想更深入地了解这个主题，本节将提供更多资源。

### 教程

*   [如何为机器学习准备数据](https://machinelearningmastery.com/how-to-prepare-data-for-machine-learning/)
*   [应用机器学习过程](https://machinelearningmastery.com/process-for-working-through-machine-learning-problems/)

### 书

*   [特征工程和选择:预测模型的实用方法](https://amzn.to/2VLgpex)，2019。
*   [机器学习的特征工程](https://amzn.to/3b9tp3s)，2018。
*   [应用预测建模](https://amzn.to/2VMhnat)，2013。
*   [数据挖掘:实用机器学习工具与技术](https://amzn.to/2Kk6tn0)，第 4 版，2016。

### 文章

*   [数据准备，维基百科](https://en.wikipedia.org/wiki/Data_preparation)。
*   数据清理，维基百科。
*   [数据预处理，维基百科](https://en.wikipedia.org/wiki/Data_pre-processing)。

## 摘要

在本教程中，您发现了如何将数据准备视为更广泛的预测建模机器学习项目中的一个步骤。

具体来说，您了解到:

*   每个带有机器学习的预测建模项目都是不同的，但是每个项目都有共同的步骤。
*   数据准备包括最好地将问题的未知底层结构暴露给学习算法。
*   项目中数据准备之前和之后的步骤可以告知应用或者至少探索哪些数据准备方法。

**你有什么问题吗？**
在下面的评论中提问，我会尽力回答。