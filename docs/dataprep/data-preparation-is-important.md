# 为什么数据准备在机器学习中如此重要

> 原文：<https://machinelearningmastery.com/data-preparation-is-important/>

最后更新于 2020 年 6 月 30 日

在预测建模项目中，机器学习算法学习从输入变量到目标变量的映射。

预测建模项目最常见的形式包括所谓的结构化数据或表格数据。这是电子表格或矩阵中的数据，每个示例都有行示例和列特征。

我们无法在原始数据上拟合和评估机器学习算法；相反，我们必须对数据进行转换，以满足单个机器学习算法的要求。更重要的是，我们必须为数据选择一种表示方式，最好地将预测问题的未知底层结构暴露给学习算法，以便在预测建模项目中获得最佳表现。

鉴于我们在开源库中有高度参数化的机器学习算法的标准实现，拟合模型已经成为常规。因此，每个预测建模项目最具挑战性的部分是如何准备项目特有的一件事:用于建模的数据。

在本教程中，您将发现数据准备对于每个机器学习项目的重要性。

完成本教程后，您将知道:

*   机器学习中的结构化数据由一个大表中的行和列组成。
*   数据准备是每个机器学习项目的必要步骤。
*   机器学习算法的常规性意味着每个项目的大部分精力都花在了数据准备上。

**用我的新书[机器学习的数据准备](https://machinelearningmastery.com/data-preparation-for-machine-learning/)启动你的项目**，包括*分步教程*和所有示例的 *Python 源代码*文件。

我们开始吧。

![Why Data Preparation Is So Important in Machine Learning](img/ac5d006b935c1f9cb9df5c51810f0228.png)

为什么数据准备在机器学习中如此重要
图片由[lwt 93](https://flickr.com/photos/37195641@N03/9433745634/)提供，保留部分权利。

## 教程概述

本教程分为三个部分；它们是:

1.  什么是机器学习中的数据
2.  必须准备原始数据
    1.  机器学习算法期待数字
    2.  机器学习算法有要求
    3.  模型表现取决于数据
3.  预测建模主要是数据准备

## 什么是机器学习中的数据

预测建模项目涉及从数据中学习。

数据指的是领域中的例子或案例，它们描述了您想要解决的问题。在监督学习中，数据由示例组成，其中每个示例都有一个将提供给模型的输入元素和一个模型预期预测的输出或目标元素。

> 我们所说的数据是对现实世界现象的观察。[……]每一条数据都提供了一个了解现实有限方面的小窗口。

—第 1 页，[机器学习的特征工程](https://amzn.to/3b9tp3s)，2018。

分类是目标是标签的监督学习问题的例子，回归是目标是数字的监督学习问题的例子。

输入数据可以有多种形式，如图像、时间序列、文本、视频等。最常见的输入数据类型通常称为表格数据或结构化数据。这是您可能在电子表格、数据库或逗号分隔变量(CSV)文件中看到的数据。这是我们将关注的数据类型。

想象一个大的数据表。在[线性代数](https://machinelearningmastery.com/linear-algebra-machine-learning-7-day-mini-course/)中，我们把这个数据表称为[矩阵](https://machinelearningmastery.com/introduction-matrices-machine-learning/)。该表由行和列组成。一行代表问题域中的一个示例，可以称为“*示例*”、“*实例*”或“*案例*”。一列表示关于该示例观察到的属性，并且可以被称为“*变量*”、“*特征*”或“*属性*”。

*   **排**。领域中的单个例子，通常称为机器学习中的一个实例或例子。
*   **列**。为每个示例记录的单个属性，在机器学习中通常称为变量或特征。

例如，用于模型输入的列称为输入变量，包含要预测的目标的列称为输出变量。用于训练模型的行称为训练数据集，用于评估模型的行称为测试数据集。

*   **输入变量**:提供给模型的数据集中的列，以便进行预测。
*   **输出变量**。要由模型预测的数据集中的列。

当您收集数据时，您可能必须对其进行转换，使其形成一个大表。

例如，如果您的数据在关系数据库中，通常会以所谓的“[范式](https://en.wikipedia.org/wiki/Database_normalization)”在单独的表中表示实体，从而最大限度地减少冗余。为了创建一个每个“主题”或“实体”一行的大型表，您可能需要反转这个过程，并在数据中引入冗余，这个过程称为[反规格化](https://en.wikipedia.org/wiki/Denormalization)。

如果您的数据在电子表格或数据库中，标准做法是以 CSV 格式提取并保存数据。这是一个标准的表示，它是可移植的，易于理解的，并且可以用于预测建模过程，没有外部依赖。

现在我们已经熟悉了结构化数据，让我们看看为什么我们需要在模型中使用数据之前准备数据。

## 必须准备原始数据

从您的域中收集的数据被称为原始数据，是在您想要解决的问题的上下文中收集的。

这意味着你必须首先定义你想要预测的东西，然后收集你认为有助于你做出最佳预测的数据。这种数据收集工作通常需要一位领域专家，并且可能需要多次重复收集更多的数据，无论是在新的数据行变得可用时，还是在新的列被确定为可能与进行预测相关时。

*   **原始数据**:域中提供的表单数据。

几乎在所有情况下，原始数据都需要更改，然后才能将其用作机器学习建模的基础。

> 要素是原始数据的一个方面的数字表示。特征位于机器学习管道中的数据和模型之间。特征工程是从原始数据中提取特征并将它们转换成适合机器学习模型的格式的行为。

—第七页，[机器学习的特征工程](https://amzn.to/3b9tp3s)，2018。

没有数据准备的情况是如此罕见或如此微不足道，以至于在每个机器学习项目中准备原始数据实际上是一条规则。

机器学习项目中必须准备原始数据的主要原因有三个。

让我们依次看一下每一个。

### 1.机器学习算法期待数字

即使您的数据表示在一个由行和列组成的大型表中，表中的变量也可能具有不同的数据类型。

有些变量可能是数字，如整数、浮点值、等级、比率、百分比等。其他变量可能是名称、类别或用字符或单词表示的标签，有些可能是二进制的，用 0 和 1 或 True 和 False 表示。

问题是，机器学习算法的核心是对数字数据进行操作。他们以数字为输入，预测数字为输出。使用线性代数的术语，所有数据都被视为向量和矩阵。

因此，在训练、评估和使用机器学习模型之前，必须改变原始数据。

有时数据的变化可以由机器学习算法在内部管理；最常见的是，这必须由机器学习从业者在建模之前在通常被称为“*数据准备*或“*数据预处理*”中处理。

### 2.机器学习算法有要求

即使您的原始数据只包含数字，也可能需要一些数据准备。

对于给定的预测建模项目，有许多不同的机器学习算法可供选择。我们无法知道哪种算法合适，更不用说最适合我们的任务了。因此，系统地评估一套不同的候选算法，并发现哪些算法在我们的数据上运行良好或最佳，是一种很好的做法。

问题是，每个算法对于数据都有特定的要求或期望。

> …数据准备可以决定模型的预测能力。不同的模型对模型中预测因子的类型有不同的敏感性；预测者如何进入模型也很重要。

—第 27 页，[应用预测建模](https://amzn.to/3b2LHTL)，2013 年。

例如，一些算法假设每个输入变量，也许还有目标变量，都有特定的概率分布。对于期望每个数字输入变量具有高斯概率分布的线性机器学习模型来说，情况往往如此。

这意味着，如果您有非高斯或近似高斯的输入变量，您可能需要更改它们，使它们是高斯或更高斯的。或者，它可能会鼓励您重新配置算法，以便对数据有不同的预期。

众所周知，如果存在与目标变量无关或冗余的输入变量，某些算法的表现会更差。如果两个或多个输入变量[高度相关](https://machinelearningmastery.com/how-to-use-correlation-to-understand-the-relationship-between-variables/)，也有算法受到负面影响。在这些情况下，可能需要识别和移除不相关或高度相关的变量，或者可能需要使用替代算法。

还有一些算法对输入变量的概率分布或冗余的存在有很少的要求，但反过来，可能需要更多的例子(行)，以便学习如何做出好的预测。

> 数据预处理的需求由所使用的模型类型决定。一些程序，如基于树的模型，对预测数据的特征明显不敏感。其他的，像线性回归，不是。

—第 27 页，[应用预测建模](https://amzn.to/3b2LHTL)，2013 年。

因此，数据和算法的选择之间是相互影响的。首先，算法对数据施加了期望，遵守这些期望需要适当地准备数据。相反，数据的形式可能有助于选择更可能有效的算法进行评估。

### 3.模型表现取决于数据

即使您准备数据以满足每个模型的期望，您也可能无法获得最佳表现。

通常，具有强烈期望的机器学习算法的表现会优雅地降低到违背期望的程度。

此外，一个算法比其他方法表现好或更好是很常见的，即使它的期望被忽略或完全违背。这是一种很常见的情况，在准备和评估机器学习算法时必须考虑到这一点。

> 在模型中有不同的方法来表示预测器，并且其中一些表示比其他的更好，这种想法导致了特征工程的想法——创建数据表示的过程，以提高模型的有效性。

—第 3 页，[特征工程与选择](https://amzn.to/2Wu7zlL)，2019。

机器学习算法的表现只有用来训练它的数据好。这常被概括为“**垃圾进，垃圾出**”。垃圾是苛刻的，但它可能意味着问题的“*弱表示”*，不足以捕捉学习如何将输入示例映射到输出所需的动态。

让我们理所当然地认为我们有“*”足够的*”数据来捕捉输入和输出变量之间的关系。这是一个狡猾的和特定领域的原则，在实践中，我们有我们拥有的数据，我们的工作是尽我们所能利用这些数据。

数据集可能是我们试图解决的问题的“*弱表示*”，原因有很多，尽管主要有两类原因。这可能是因为复杂的非线性关系被压缩在原始数据中，这些原始数据可以使用数据准备技术进行解包。这也可能是因为数据并不完美，从被称为统计噪声的观测值的轻微随机波动，到导致超范围值和数据冲突的误差。

*   **复杂数据**:原始数据包含可能需要暴露的压缩复杂非线性关系
*   **杂乱的数据**:原始数据包含统计噪声、错误、缺失值和冲突示例。

我们可以考虑通过两种方式充分利用我们的预测建模项目:关注模型和关注数据。

我们可以最低限度地准备原始数据并开始建模。这就把梳理数据中的关系和尽最大努力学习从输入到输出的映射函数的全部责任放在了模型上。这可能是一个合理的项目路径，可能需要一个大的数据集和一个灵活强大的机器学习算法，几乎没有期望，例如[随机森林](https://machinelearningmastery.com/random-forest-ensemble-in-python/)或[梯度提升](https://machinelearningmastery.com/gradient-boosting-machine-ensemble-in-python/)。

或者，我们可以将责任推回到数据和数据准备过程上。这要求每一行数据最大或最好地表达建模数据的信息内容。就像将关系数据库中的数据反规范化为行和列一样，数据准备可以反规范化每个单个观察中固有的复杂结构。这也是一条合理的路径。它可能需要比现有数据更多的数据知识，但是几乎不管所使用的机器学习算法如何，都可以实现良好甚至最佳的建模表现。

在任何给定的项目中，通常都会在这些方法之间寻求平衡。这既是探索强大而灵活的机器学习算法，也是使用数据准备来向学习算法最好地展示数据结构。

这就是说，数据预处理是获得更好数据的途径，进而获得更好的模型表现。

## 预测建模主要是数据准备

用机器学习算法建模数据已经成为常规。

大多数常见的、流行的和广泛使用的机器学习算法已经有几十年的历史了。线性回归已经有 100 多年的历史了。

也就是说，大多数算法都被很好地理解和参数化，并且在开源软件中有标准的定义和实现，比如 Python 中的 Sklearn 机器学习库。

虽然这些算法在操作上已经被很好地理解，但是大多数都没有令人满意的理论来解释它们为什么工作或者如何将算法映射到问题上。这就是为什么每个预测建模项目都是经验性的，而不是理论性的，需要对数据进行算法的系统实验。

考虑到机器学习算法在很大程度上是例行公事，不同项目之间唯一不同的是建模中使用的特定数据。

> 数据质量是数据管理中最重要的问题之一，因为脏数据通常会导致不准确的数据分析结果和不正确的业务决策。

—第十三页，[数据清理](https://amzn.to/2SARxFG)，2019。

如果您已经为分类或回归预测建模问题收集了数据，这可能是有史以来第一次对问题进行建模。你正在开拓新的领域。这并不是说这类问题以前没有解决过；它可能有，如果结果被公布，你可以从发现的东西中学习。但正是在今天，您的特定观察集合使您的预测建模问题变得独特。

因此，您的项目的大部分将花费在数据上。收集数据、验证数据、清理数据、可视化数据、转换数据等等。

> …据说高达 80%的数据分析花费在清理和准备数据的过程中。然而，作为数据分析工作流的其余部分(可视化、建模、报告)的先决条件，在数据争论技术方面变得流畅和高效是至关重要的。

—第五页，[与 R](https://amzn.to/2z8NB8k) 的数据角力，2016。

你的工作是发现如何最好地将学习算法暴露给你预测问题的未知底层结构。到达那里的途径是通过数据准备。

为了成为一名有效的机器学习实践者，您必须知道:

*   项目中需要考虑的不同类型的数据准备。
*   每类数据准备技术的前几个算法。
*   何时使用以及如何配置顶级数据准备技术。

这通常是来之不易的知识，因为很少有专门针对该主题的资源。相反，你必须经常查阅统计数据和应用论文的文献，以了解什么是可用的以及如何使用它。

> 从业者一致认为，构建机器学习管道的绝大部分时间都花在了特征工程和数据清理上。然而，尽管这个话题很重要，却很少单独讨论。

—第七页，[机器学习的特征工程](https://amzn.to/3b9tp3s)，2018。

## 进一步阅读

如果您想更深入地了解这个主题，本节将提供更多资源。

### 书

*   [特征工程和选择:预测模型的实用方法](https://amzn.to/2VLgpex)，2019。
*   [应用预测建模](https://amzn.to/2VMhnat)，2013。
*   [数据挖掘:实用机器学习工具与技术](https://amzn.to/2Kk6tn0)，第 4 版，2016。

### 文章

*   [数据准备，维基百科](https://en.wikipedia.org/wiki/Data_preparation)。
*   数据清理，维基百科。
*   [数据预处理，维基百科](https://en.wikipedia.org/wiki/Data_pre-processing)。

## 摘要

在本教程中，您发现了数据准备对于每个机器学习项目的重要性。

具体来说，您了解到:

*   机器学习中的结构化数据由一个大表中的行和列组成。
*   数据准备是每个机器学习项目的必要步骤。
*   机器学习算法的常规性意味着每个项目的大部分精力都花在了数据准备上。

**你有什么问题吗？**
在下面的评论中提问，我会尽力回答。