# 如何开发联合概率、边缘概率和条件概率的直觉

> 原文：<https://machinelearningmastery.com/how-to-calculate-joint-marginal-and-conditional-probability/>

最后更新于 2019 年 12 月 6 日

单个随机变量的概率是直截了当的，尽管当考虑两个或更多变量时，它会变得复杂。

仅用两个变量，我们可能会对同时发生的两个事件的概率感兴趣，称为联合概率:一个事件给定另一个事件发生的概率称为条件概率，或者仅一个事件的概率而不考虑其他变量，称为边缘概率。

这些类型的概率很容易定义，但是它们背后的直觉可能需要一些时间来理解，需要一些可行的例子来修改。

在本教程中，您将发现计算联合概率、边缘概率和条件概率背后的直觉。

完成本教程后，您将知道:

*   如何计算独立随机变量的联合概率、边缘概率和条件概率？
*   如何从联合随机变量中收集观测值并构造联合概率表？
*   如何从联合概率表中计算联合概率、边缘概率和条件概率？

**用我的新书[机器学习概率](https://machinelearningmastery.com/probability-for-machine-learning/)启动你的项目**，包括*分步教程*和所有示例的 *Python 源代码*文件。

我们开始吧。

*   **2019 年 10 月更新**:修复了一些小错别字，感谢 Minel 和 jmy。
*   **2019 年 12 月更新**:修正了联合概率表描述中的错别字。

![Probabilistic Model Selection Measures AIC, BIC, and MDL](img/55215c0c8e43b6024b437b2ef20c0491.png)

如何培养联合概率、边缘概率和条件概率的直觉
图片由吉尔姆·维尔鲁特提供，版权所有。

## 教程概述

本教程分为三个部分；它们是:

1.  联合概率、边缘概率和条件概率
2.  掷骰子的概率
3.  两个城市的天气概率

## 联合概率、边缘概率和条件概率

当使用单个随机变量时，计算概率相对简单。

当考虑两个或更多的随机变量时，它会变得更有趣，就像我们在许多现实世界中经常做的那样。

当处理两个(或更多)随机变量时，我们可能对计算三种主要类型的概率感兴趣。

简而言之，它们是:

*   **联合概率**。同时发生事件的概率。
*   **边缘概率**。不考虑其他变量的事件概率。
*   **条件概率**。给定其他事件出现的概率。

这些不同类型的概率的含义和计算方法因两个随机变量是独立的(更简单)还是相关的(更复杂)而异。

我们将通过实例来探讨如何计算和解释这三种概率。

在下一节中，我们将看两个骰子的独立掷骰子，在下一节中，我们将看两个地理位置相近的城市的天气事件的发生。

## 掷骰子的概率

探索联合概率和边缘概率的一个好的起点是考虑独立的随机变量，因为计算非常简单。

公平骰子的滚动给出了数字 1 到 6 出现的六分之一(1/6)或 0.166 (16.666%)的概率。

*   p(指数 1=1) = 1/6
*   p(指数 1=2) = 1/6
*   p(指数 1=3) = 1/6
*   p(指数 1=4) = 1/6
*   p(指数 1=5) = 1/6
*   p(指数 1=6) = 1/6

如果我们掷出第二个骰子，我们在那个骰子上得到每个值的概率是相同的。骰子的每个事件都有相等的概率，骰子 1 和骰子 2 的滚动不会相互影响。

*   p(索引 1={1，2，3，4，5，6}) = 1.0
*   p(索引 2={1，2，3，4，5，6}) = 1.0

首先，我们可以将骰子 1 滚动偶数的概率计算为滚动 2、4 或 6 的概率之和，例如:

*   p(索引 1={2，4，6}) = P(索引 1=2) + P(索引 1=4) + P(索引 1=6)
*   p(索引 1={2，4，6}) = 1/6 + 1/6 + 1/6

这是 0.5%或 50%，正如我们可能直观地预期的那样。

现在，我们可以考虑用两个骰子同时掷出偶数的联合概率。独立随机变量的联合概率计算如下:

*   P(A 和 B) = P(A) * P(B)

这是通过 dice1 滚动偶数的概率乘以 dice2 滚动偶数的概率来计算的。第一个事件的概率约束了第二个事件的概率。

*   p(索引 1={2，4，6}和索引 2={2，4，6}) = P(索引 1={2，4，6}) * P(索引 2={2，4，6})

我们知道每个骰子滚动一个偶数的概率是 0.5，因此滚动两个偶数的概率是 3/6 或 0.5。插上它，我们得到:0.5 * 0.5 (0.25)或 25%。

另一种看待这个问题的方法是考虑滚动一个模具给出 6 种组合。将两个骰子滚动在一起，骰子 2 的 6 个组合或(6×6) 36 个组合中的每一个都有 6 个组合。dice1 的 6 个组合中总共有 3 个是偶数，这些组合的 6 个组合中有 3 个是偶数。这给出了 36 个组合中的(3×3) 9 个作为每个管芯的偶数或者(9/36 = 0.25) 25%。

**提示**:如果你在处理带有离散事件的自变量时，曾经对自己的概率计算有过疑问，那就用组合的方式来思考，事情会再次有意义。

我们可以根据我们对该领域的了解，构建一个联合概率表。下表列出了完整的表格，顶部(x 轴)为 dice1，侧面(y 轴)为 dice2。使用联合概率公式计算给定小区的每个事件的联合概率，例如 0.166 * 0.166 或 0.027 或约 2.777%。

```py
   1      2      3      4      5      6
1  0.027  0.027  0.027  0.027  0.027  0.027
2  0.027  0.027  0.027  0.027  0.027  0.027
3  0.027  0.027  0.027  0.027  0.027  0.027
4  0.027  0.027  0.027  0.027  0.027  0.027
5  0.027  0.027  0.027  0.027  0.027  0.027
6  0.027  0.027  0.027  0.027  0.027  0.027
```

此表捕获了两个随机变量 dice1 和 dice2 事件的联合概率分布。这很无聊，但我们可以用它来加深我们对自变量联合概率和边缘概率的理解。

例如，用 dice1 滚动 a 2 和用 dice2 滚动 a 2 的联合概率可以直接从表中读出为 2.777%。我们可以探索更复杂的情况，例如用 dice1 滚动 2，用 dice2 滚动奇数。

这可以通过将第二列中用 dice1 滚动 2 的值与用 dice2 滚动奇数的第一、第三和第五行的值相加来读取。

*   p(索引 1=2，索引 2={1，3，5}) = 0.027 + 0.027 + 0.027

这一数字约为 0.083，约为 8.333%。

我们也可以用这个表来计算边缘概率。这被计算为 dice1 的一整列概率或 dice2 的一行概率的总和。

例如，我们可以用 dice2 作为表格最后一行的概率总和来计算滚动 6 的边缘概率。这大约是 0.166 或 16.666%，正如我们可能直观预期的那样。

重要的是，如果我们对表中所有单元格的概率求和，它必须等于 1.0。此外，如果我们对每行的概率求和，那么这些和的总和必须等于 1.0。同样，如果我们对每一列的概率求和，那么这些和的和也必须等于 1.0。这是对联合概率表的要求。

因为事件是独立的，所以计算条件概率没有什么特别的需要。

*   P(给定的 B) = P(A)

例如，无论用 dice1 滚动什么，用 DIC E1 滚动 2 的概率是相同的。

*   p(索引 1=2 给定索引 2=6) = P(索引 1=2)

这样，条件概率对于独立随机变量就没有了有用的意义。

开发一个联合概率表是一个有用的工具，有助于更好地理解如何计算和探索联合概率和边缘概率。

在下一节中，让我们来看一个更复杂的带有因变量的例子。

## 两个城市的天气概率

我们可以利用两个相依随机变量的事件联合概率表来发展联合概率和边缘概率的直觉。

考虑一下有两个城市的情况，*城市*和*城市*。这些城市离得很近，一般都会受到相同天气的影响，但它们之间的距离又很远，所以不会受到相同天气的影响。

我们可以考虑这些城市在某一天的离散天气分类，如*晴天*、*多云*、*雨天*。当城市天气晴朗时，城市天气通常晴朗，但并不总是如此。因此，这两个城市的天气相互依存。

现在，让我们探索不同类型的概率。

### 数据收集

首先，我们可以记录每个城市二十多天的观测天气。

例如，在第一天，第二天的天气如何，等等。

```py
Day | City1 | City2
1     Sunny   Sunny
2     Sunny   Cloudy
3
...
```

为了简洁起见，省略了完整的结果表，我们将在后面补充总数。

然后，我们可以计算观察到的配对事件总数的总和。

例如，城市晴天和城市晴天的总次数，城市晴天和城市多云的总次数，等等。

```py
City 1 | City 2 | Total
sunny    sunny    6/20
sunny    cloudy   1/20
sunny    rainy    0/20
...
```

同样，为了简洁起见，完整的表格被省略了，我们将在后面补充总数。

这些数据为探索这两个城市发生天气事件的概率提供了依据。

### 联合概率

首先，我们可能对每个城市发生天气事件的概率感兴趣。

我们可以创建一个包含成对或联合天气事件概率的表格。

下表总结了这两个城市的每种离散天气的概率，其中城市定义在顶部(x 轴)，城市定义在侧面(y 轴)。

```py
          Sunny | Cloudy | Rainy
Sunny     6/20    2/20     0/20
Cloudy    1/20    5/20     2/20
Rainy     0/20    1/20     3/20
```

表格中的一个单元格描述了每个城市中事件的联合概率，表格中的概率一起总结了两个城市天气事件的联合概率分布。

表中所有单元格的联合概率之和必须等于 1.0。

我们可以计算出两个城市天气的联合概率。例如，我们预计两个城市同时晴朗的联合概率很高。这可以正式表述为:

*   p(城市=阳光充足，城市=阳光充足)

或者更简洁地说:

*   p(晴天，晴天)

我们可以直接从表格中读出 6/20 或 0.3 或 30%。相对较高的概率。

我们可以更进一步，考虑第一个城市不下雨，第二个城市下雨的概率。我们可以这样说:

*   p(城市=晴天或阴天，城市=雨天)

同样，我们可以直接从表中计算出来。首先，P(晴，雨)为 0/20，P(阴，雨)为 1/20。然后我们可以把这些概率加在一起，得出 1/20 或 0.05 或 5%。这可能发生，但不太可能。

该表还给出了事件边际分布的概念。例如，我们可能对某个城市出现晴天的概率感兴趣，不管这个城市发生了什么。这可以通过对阳光充足的城市的概率求和从表中读出，例如概率的第一列:

*   P(市=晴)= P(市=晴，市=晴)+ P(市=晴，市=多云)+ P(市=晴，市=雨)

或者

*   p(1 =晴天)= 6/20 + 1/20 + 0/20
*   p(1 =晴天)= 7/20

因此，某市晴天的边缘概率为 0.35 或 35%。

我们可以通过连续计算一个事件在部分或全部概率范围内的边缘概率来为 city 做同样的事情。例如，城市中雨天的概率将被计算为沿着表格底部一行的概率之和:

*   p(市=多雨)= 0/20 + 1/20 + 3/20
*   p(市=多雨)= 4/20

因此，城市雨天的边缘概率为 0.2%或 20%。

边缘概率通常是有趣和有用的，更新联合概率表以包括它们是一个好主意；例如:

```py
          Sunny | Cloudy | Rainy | Marginal
Sunny     6/20    2/20     0/20    8/20
Cloudy    1/20    5/20     2/20    8/20
Rainy     0/20    1/20     3/20    4/20
Marginal  7/20    8/20     5/20    20/20
```

### 条件概率

鉴于另一个城市发生天气事件，我们可能对天气事件的概率感兴趣。

这被称为条件概率，可以使用联合概率和边缘概率来计算。

*   P(给定的 B) = P(A 和 B) / P(B)

例如，我们可能对某个城市阳光充足的概率感兴趣，因为某个城市阳光充足。

这可以正式表述为:

*   P(1 =阳光充足给定的城市=阳光充足)= P(1 =阳光充足且城市=阳光充足)/ P(城市=阳光充足)

我们可以从上一节的表格中填写联合概率和边缘概率；例如:

*   p(1 =晴天给定的城市=晴天)= 6/20 / 8/20
*   p(1 =阳光充足给定的城市=阳光充足)= 0.3 / 0.4

这个出来是 0.75 或者 75%，很直观。我们预计，如果城市天气晴朗，那么城市大部分时间也应该是晴朗的。

这不同于两个城市在某一天都是晴天的联合概率，后者的概率较低，为 30%。

如果从组合数的角度来考虑更有意义。在这种有条件的情况下，我们有更多的信息，因此我们不必计算所有 20 天的概率。具体来说，我们假设市内是晴天，这就大大减少了天数，从 20 天减少到 8 天。在城市中，总共有 6 天是晴天，在城市中也是晴天，比例为 6/8 或(0.75) 75%。

所有这些都可以从联合概率表中看出。

条件概率经常被误解的一个重要方面是它是不可逆的。

*   p(给定的 B)！= P(给定 A 的 B)

也就是说，假设某个城市是晴天，那么这个城市是晴天的概率与假设某个城市是晴天的概率是不一样的。

*   p(11 =晴天给定的城市=晴天)！= P(城市=阳光充足给定的城市=阳光充足)

在这种情况下，假设某个城市是晴天，那么该城市是晴天的概率计算如下:

*   P(城市=阳光充足给定的城市=阳光充足)= P(城市=阳光充足且城市=阳光充足)/ P(城市=阳光充足)
*   p(city = sunny 给定的 city = sunny)= 6/20/7/20
*   p(city = sunny 给定的 city = sunny)= 0.3/0.35
*   p(city = sunny 给定的 city = sunny)= 0.857

在这种情况下，它更高，约为 85.714%。

我们也可以用条件概率来计算联合概率。

*   P(A 和 B) = P(给定的 B) * P(B)

例如，如果我们只知道给定城市中晴天的条件概率和城市的边缘概率，我们可以将联合概率计算为:

*   P(城=阳光充足，城=阳光充足)= P(城=阳光充足，给定城=阳光充足)* P(城=阳光充足)
*   p(城市=阳光充足，城市=阳光充足)= 0.857 * 0.35
*   p(1 =阳光充足，1 =阳光充足)= 0.3

这给出了我们预期的 0.3%或 30%。

## 进一步阅读

如果您想更深入地了解这个主题，本节将提供更多资源。

### 书

*   [概率:对于热情的初学者](https://amzn.to/2jULJsu)，2016 年。
*   [模式识别与机器学习](https://amzn.to/2JwHE7I)，2006。
*   [机器学习:概率视角](https://amzn.to/2xKSTCP)，2012。

### 文章

*   [概率，维基百科](https://en.wikipedia.org/wiki/Probability)。
*   [概率统计中的符号，维基百科](https://en.wikipedia.org/wiki/Notation_in_probability_and_statistics)。
*   [独立性(概率论)，维基百科](https://en.wikipedia.org/wiki/Independence_(probability_theory))。
*   [独立同分布随机变量，维基百科](https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables)。
*   [相互排他性，维基百科](https://en.wikipedia.org/wiki/Mutual_exclusivity)。
*   [边际分布，维基百科](https://en.wikipedia.org/wiki/Marginal_distribution)。
*   [联合概率分布，维基百科](https://en.wikipedia.org/wiki/Joint_probability_distribution)。
*   [条件概率，维基百科](https://en.wikipedia.org/wiki/Conditional_probability)。

## 摘要

在本教程中，您发现了计算联合概率、边缘概率和条件概率背后的直觉。

具体来说，您了解到:

*   如何计算独立随机变量的联合概率、边缘概率和条件概率？
*   如何从联合随机变量中收集观测值并构造联合概率表？
*   如何从联合概率表中计算联合概率、边缘概率和条件概率？

你有什么问题吗？
在下面的评论中提问，我会尽力回答。