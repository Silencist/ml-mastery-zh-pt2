# 函数优化的温和介绍

> 原文：<https://machinelearningmastery.com/introduction-to-function-optimization/>

最后更新于 2021 年 10 月 12 日

**函数优化**是一个基础研究领域，该技术几乎用于每个定量领域。

重要的是，函数优化是几乎所有机器学习算法和预测建模项目的核心。因此，理解什么是函数优化、该领域中使用的术语以及构成函数优化问题的要素是至关重要的。

在本教程中，您将发现函数优化的温和介绍。

完成本教程后，您将知道:

*   函数优化的三个要素，即候选解、目标函数和成本。
*   将函数优化概念化为导航搜索空间和响应面。
*   求解函数优化问题时全局最优与局部最优的区别。

**用我的新书[机器学习优化](https://machinelearningmastery.com/optimization-for-machine-learning/)启动你的项目**，包括*分步教程*和所有示例的 *Python 源代码*文件。

Let’s get started.![A Gentle Introduction to Function Optimization](img/2c526e355033b124a0c7977da202ed63.png)

函数优化简介
图片由 [USFS 提供，内饰西国际汽联](https://www.flickr.com/photos/142650051@N06/41329643362/)，版权所有。

## 教程概述

本教程分为四个部分；它们是:

1.  函数优化
2.  候选解决方案
3.  目标函数
4.  评估成本

## 函数优化

函数优化是数学的一个分支，在现代是用数值计算方法解决的。

**连续函数优化**(“*函数优化*”这里简称)属于一个更广泛的研究领域叫做[数学优化](https://en.wikipedia.org/wiki/Mathematical_optimization)。

它不同于其他类型的优化，因为它涉及寻找由数字输入变量组成的最佳候选解，而不是由序列或组合组成的候选解(例如组合优化)。

函数优化是一个广泛使用的工具包，包含了几乎所有科学和工程学科采用的技术。

> 人优化。投资者寻求创建避免过度风险同时实现高回报率的投资组合。[……]优化是决策科学和物理系统分析中的重要工具。

—第 2 页，[数值优化](https://amzn.to/2S6S9lN)，2006。

它在机器学习中起着核心作用，因为几乎所有的机器学习算法都使用函数优化来使模型适合训练数据集。

例如，将一条线拟合到一组点需要解决一个优化问题。在训练数据集中拟合线性回归或神经网络模型也是如此。

通过这种方式，优化提供了一种工具来使一般模型适应特定的情况。学习被视为一个优化或搜索问题。

实际上，函数优化描述了一类寻找给定函数的输入的问题，该问题导致函数的最小或最大输出。

> 目标取决于系统的某些特征，称为变量或未知数。我们的目标是找到优化目标的变量值。

—第 2 页，[数值优化](https://amzn.to/2S6S9lN)，2006。

函数优化涉及三个要素:函数的输入(如 *x* )、目标函数本身(如 *f()* )和函数的输出(如*成本*)。

*   **输入(x)** :待评估函数的输入，例如候选解。
*   **函数(f())** :评估输入的目标函数或目标函数。
*   **成本**:以最小化或最大化为目标函数对候选解进行评估的结果。

让我们依次仔细看看每个元素。

## 候选解决方案

候选解是目标函数的单一输入。

候选解的形式取决于目标函数的细节。它可以是单个浮点数、数字向量、数字矩阵，也可以是特定问题域所需的复杂数字。

最常见的是数字向量。对于一个测试问题，向量表示函数的每个输入变量的具体值( *x = x1，x2，x3，…，xn* )。对于机器学习模型，向量可以表示模型系数或权重。

> 从数学上讲，最优化是一个函数在变量约束下的最小化或最大化。

—第 2 页，[数值优化](https://amzn.to/2S6S9lN)，2006。

问题域或目标函数可能会对候选解施加约束。这可能包括以下方面:

*   变量的数量(1，20，1，000，000 等。)
*   变量的数据类型(整数、二进制、实值等)。)
*   可接受值的范围(在 0 和 1 之间，等等。)

重要的是，候选解决方案是离散的，并且有很多。

候选解决方案的范围可能很广，大到无法列举。相反，我们能做的最好的事情是在搜索空间中对候选解决方案进行采样。作为一名实践者，我们寻求一种优化算法，该算法最大限度地利用关于问题的可用信息，有效地对搜索空间进行采样，并找到一个好的或最佳的候选解决方案。

*   **搜索空间**:由目标函数的可接受输入的数量、类型和范围定义的候选解的宇宙。

最后，候选解可以根据目标函数对它们的评估进行排序，这意味着有些解比其他解更好。

## 目标函数

目标函数特定于问题域。

它可以是一个测试函数，例如一个众所周知的具有特定数量的输入变量的方程，其计算返回输入的成本。测试函数的最优值是已知的，允许算法基于它们有效导航搜索空间的能力进行比较。

在机器学习中，目标函数可能涉及将候选解插入模型中，并根据训练数据集的一部分对其进行评估，成本可能是错误分数，通常称为模型损失。

目标函数很容易定义，尽管评估起来很昂贵。函数优化的效率是指最小化函数求值的总数。

虽然目标函数很容易定义，但优化可能很有挑战性。目标函数的难度可能从能够直接使用微积分或[线性代数](https://machinelearningmastery.com/linear-algebra-machine-learning-7-day-mini-course/)解析求解该函数(简单)到使用局部搜索算法(中等)再到使用全局搜索算法(困难)。

目标函数的难度取决于对该函数的了解程度。这通常不能通过简单地回顾评估候选解的等式或代码来确定。相反，它指的是响应面的结构。

响应面(或搜索范围)是成本相对于候选解决方案搜索空间的几何结构。例如，平滑的响应面表明输入(候选解)的微小变化会导致目标函数的输出(成本)的微小变化。

*   **响应面**:响应候选解变化的目标函数的成本几何属性。

响应面可以低维可视化，例如对于具有一个或两个输入变量的候选解。一维输入可以绘制为 2D 散点图，输入值在 x 轴，成本在 y 轴。二维输入可以绘制为 3D 表面图，x 轴和 y 轴上有输入变量，表面高度代表成本。

在最小化问题中，差的解将在响应面中表示为小山，好的解将由山谷表示。为了最大化问题，这将是颠倒的。

这个响应面的结构和形状决定了算法在搜索空间中找到解决方案的难度。

真实目标函数的复杂性意味着我们不能分析表面，并且函数评估的输入和计算成本的高维数使得映射和绘制真实目标函数变得困难。

## 评估成本

候选解的代价几乎总是一个实数。

成本值的比例将根据目标函数的具体情况而变化。一般来说，成本值的唯一有意义的比较是与由同一目标函数计算的其他成本值进行比较。

函数的最小或最大输出称为函数的最优值，通常简化为最小值。我们希望最大化的任何函数都可以通过在函数返回的成本前面加上负号来转换为最小化。

> 在全局优化中，找到优化问题的真正全局解；折衷是效率。全局优化方法的最坏情况复杂性随着问题规模呈指数增长…

—第 10 页，[凸优化](https://amzn.to/34mvCr1)，2004。

目标函数可能有一个最佳解，称为目标函数的全局最优解。或者，目标函数可能有许多全局最优解，在这种情况下，我们可能有兴趣定位它们中的一个或全部。

> 许多数值优化方法寻求局部极小值。局部极小值是局部最优的，但是我们通常不知道局部极小值是否是全局极小值。

—第 8 页，[优化算法](https://amzn.to/33cgvkm)，2019。

除了全局最优解之外，一个函数可能还有局部最优解，这是很好的候选解，可能相对容易定位，但不如全局最优解。对于搜索算法来说，局部最优可能看起来是全局最优，例如可能在响应面的谷中，在这种情况下，我们可能称它们是欺骗性的，因为算法会很容易定位它们并卡住，无法定位全局最优。

*   **全局最优**:目标函数中成本最优的候选解。
*   **本地 Optima** 。候选解决方案很好，但不如全局最优。

成本值的相对性质意味着可以使用简单的搜索算法(例如随机)建立具有挑战性的问题的表现基线，并且可以相对于基线比较由更复杂的搜索算法找到的最优解的“优度”。

候选解决方案通常很容易描述，也很容易构建。函数优化的挑战部分是评估候选解。

求解函数优化问题或目标函数就是寻找最优解。项目的整个目标是找到一个有好的或最好的成本的特定候选解决方案，给出可用的时间和资源。在简单和适度的问题中，我们可能能够准确地定位最佳候选解，并且对我们这样做有一定的信心。

> 许多非线性优化问题的算法只寻求局部解，即目标函数小于附近所有其他可行点的点。它们并不总是找到全局解，全局解是所有可行点中函数值最低的点。在一些应用中需要全局解决方案，但是对于许多问题，它们很难识别，甚至更难定位。

—第 6 页，[数值优化](https://amzn.to/2S6S9lN)，2006。

对于更具挑战性的问题，考虑到项目可用的时间，我们可能会对相对较好的候选解决方案感到满意(例如足够好)。

## 进一步阅读

如果您想更深入地了解这个主题，本节将提供更多资源。

### 书

*   [优化算法](https://amzn.to/33cgvkm)，2019。
*   [凸优化](https://amzn.to/34mvCr1)，2004。
*   [数值优化](https://amzn.to/2S6S9lN)，2006。

### 文章

*   [数学优化，维基百科](https://en.wikipedia.org/wiki/Mathematical_optimization)。

## 摘要

在本教程中，您发现了函数优化的温和介绍。

具体来说，您了解到:

*   函数优化的三个要素为候选解、目标函数和成本。
*   将函数优化概念化为导航搜索空间和响应面。
*   求解函数优化问题时全局最优与局部最优的区别。

**你有什么问题吗？**
在下面的评论中提问，我会尽力回答。