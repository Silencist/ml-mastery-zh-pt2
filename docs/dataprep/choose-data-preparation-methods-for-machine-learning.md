# 如何选择机器学习的数据准备方式

> 原文：<https://machinelearningmastery.com/choose-data-preparation-methods-for-machine-learning/>

最后更新于 2020 年 7 月 15 日

数据准备是预测建模项目的重要部分。

数据准备的正确应用将把原始数据转化为一种表示，这种表示允许学习算法最大限度地利用数据并做出巧妙的预测。问题是选择一个变换或变换序列来产生一个有用的表示是非常具有挑战性的。以至于它可能被认为是一门艺术而不是一门科学。

在本教程中，您将发现可用于为预测建模数据集选择数据准备技术的策略。

完成本教程后，您将知道:

*   可以根据数据集和算法的详细知识来选择数据准备技术，这是最常见的方法。
*   数据准备技术可以作为建模管道中的另一个超参数进行网格搜索。
*   数据转换可以并行应用于训练数据集，以创建许多提取的特征，在这些特征上可以应用特征选择并训练模型。

**用我的新书[机器学习的数据准备](https://machinelearningmastery.com/data-preparation-for-machine-learning/)启动你的项目**，包括*分步教程*和所有示例的 *Python 源代码*文件。

我们开始吧。

![How to Choose Data Preparation Methods for Machine Learning](img/674e6fca840a05ce83a361016b36f312.png)

如何选择机器学习的数据准备方式
图片由 [StockPhotosforFree](https://www.flickr.com/photos/stockphotosforfree/7190209597/) 提供，保留部分权利。

## 教程概述

本教程分为四个部分；它们是:

1.  选择数据准备技术的策略
2.  方法 1:手动指定数据准备
3.  方法 2:网格搜索数据准备方法
4.  方法 3:并行应用数据准备方法

## 选择数据准备技术的策略

机器学习模型的表现只有用来训练它的数据好。

这给数据和用于准备建模的技术带来了沉重的负担。

数据准备是指用于将原始数据转换成最符合机器学习算法预期或要求的形式的技术。

这是一个挑战，因为我们无法知道原始数据的表示将导致预测模型的良好或最佳表现。

> 然而，我们经常不知道改善模型表现的预测因子的最佳再现。相反，预测器的重新工作更像是一门艺术，需要正确的工具和经验来找到更好的预测器表示。此外，我们可能需要搜索许多替代的预测器表示来提高模型表现。

—第十二页，[特征工程与选择](https://amzn.to/3gMVxNE)，2019 年。

相反，我们必须使用受控实验来系统地评估模型上的数据转换，以便发现什么工作得好或最好。

因此，在预测建模项目中，我们可以决定使用三种主要策略来为数据集选择数据准备技术或技术序列；它们是:

1.  基于对数据和所选算法的深入了解，手动指定用于给定算法的数据准备。
2.  测试一套不同的数据转换和转换序列，并发现对于一个或一系列模型，什么在数据集上工作得好或最好。
3.  对数据并行应用一套数据转换，以创建大量工程特征，这些特征可以使用特征选择来减少并用于训练模型。

让我们依次仔细看看这些方法。

## 方法 1:手动指定数据准备

这种方法包括研究数据和特定算法的需求，并选择数据转换来改变您的数据以最好地满足需求。

许多从业者认为这是选择数据准备技术的唯一可能的方法，因为这通常是教科书中教授或描述的唯一方法。

这种方法可能包括首先选择一种算法，并为其专门准备数据，或者测试一套算法，并确保数据准备方法适合每种算法。

这种方法需要对数据有详细的了解。这可以通过查看每个变量的汇总统计数据、数据分布图，甚至可能通过统计测试来查看数据是否与已知分布相匹配来实现。

这种方法还需要详细了解您将使用的算法。这可以通过复习描述算法的教科书来实现。

从高层次来说，大多数算法的数据需求是众所周知的。

例如，以下算法可能对数值输入变量的规模和分布以及不相关和冗余变量的存在很敏感:

*   线性回归(和扩展)
*   逻辑回归
*   线性判别分析
*   高斯朴素贝叶斯
*   神经网络
*   支持向量机
*   k-最近邻

以下算法可能对数值输入变量的规模和分布不敏感，并且对不相关的冗余变量相当不敏感:

*   决策图表
*   adaboost 算法
*   袋装决策树
*   随机森林
*   梯度升压

这种方法的好处是，它可以让您确信您的数据已经根据特定算法的期望和要求进行了定制。这可能会带来良好甚至出色的表现。

缺点是，这可能是一个缓慢的过程，需要大量的分析、专业知识和潜在的研究。这也可能导致一种错误的信心，认为已经取得了好的或最好的结果，不可能或几乎不可能有进一步的改善。

有关这种数据准备方法的更多信息，请参见教程:

*   [什么是机器学习项目中的数据准备](https://machinelearningmastery.com/what-is-data-preparation-in-machine-learning/)

## 方法 2:网格搜索数据准备方法

这种方法承认算法可能有期望和要求，并且确实确保数据集的转换是为了满足这些要求而创建的，尽管它并不假设满足这些要求将导致最佳表现。

它为不明显和不直观的解决方案敞开了大门。

这可能是一个数据转换，“*不应该工作”*”或“*不应该适合算法*”但结果良好或伟大的表现。或者，对于被认为是“绝对必要的”*的输入变量，可能缺少数据转换，但仍会产生良好或出色的表现。*

 *这可以通过设计数据准备技术的网格搜索和/或流水线中的数据准备技术序列来实现。这可能涉及在单个选择的机器学习算法或一套机器学习算法上评估每一个。

结果将是大量的结果，这些结果将清楚地表明那些数据转换、转换序列和/或与模型相结合的转换，从而在数据集上产生良好或最佳的表现。

这些可以直接使用，尽管更有可能通过调整数据转换和模型超参数来提供进一步研究的基础，以最大限度地利用这些方法，并通过消融研究来确认建模管道的所有元素有助于熟练的预测。

我自己通常使用这种方法，并向希望在项目中快速取得好表现的初学者或从业者推荐这种方法。

这种方法的好处是，它总是会产生建模管道的建议，从而给出良好的相对结果。最重要的是，它可以为从业者挖掘不明显和不直观的解决方案，而不需要深厚的专业知识。

缺点是需要一些编程能力来实现网格搜索，以及评估许多不同的数据准备技术和管道所增加的计算成本。

有关这种数据准备方法的更多信息，请参见教程:

*   [如何网格搜索数据准备技术](https://machinelearningmastery.com/grid-search-data-preparation-techniques/)

## 方法 3:并行应用数据准备方法

像前面的方法一样，使用这种方法，假设算法有期望和要求，并且它还允许找到违背这些期望的好的解决方案，尽管它更进一步。

这种方法还承认，适合同一数据的多个视角的模型可能比适合数据的单个视角的模型更有益。

这是通过对原始数据集并行执行多个数据转换来实现的，然后将所有转换的结果收集在一起，形成一个包含数百甚至数千个输入要素的大型数据集(即 Sklearn 中的 [FeatureUnion 类](https://Sklearn.org/stable/modules/generated/sklearn.pipeline.FeatureUnion.html)可用于实现这一点)。它允许并行使用从不同变换中找到的良好输入特征。

对于使用的每个变换，输入要素的数量可能会急剧增加。因此，最好将这种方法与特征选择方法相结合，选择与目标变量最相关的特征子集。同样，这可能涉及应用一种、两种或更多种不同的特征选择技术来提供比正常情况下更大的有用特征子集。

或者，可以在生成的特征上使用降维技术(例如 [PCA](https://machinelearningmastery.com/principal-components-analysis-for-dimensionality-reduction-in-python/) ，或者可以直接在生成的特征上训练执行自动特征选择的算法(例如[随机森林](https://machinelearningmastery.com/random-forest-ensemble-in-python/))。

我喜欢把它看作是一种显式的特性工程方法，在这种方法中，我们从原始数据中生成我们可能想到的所有特性，分解数据中的分布和关系。然后选择最相关特征的子集并拟合模型。因为我们显式地使用数据转换将问题的复杂性分解为并行特征，所以它可能允许使用更简单的预测模型，例如带有强惩罚的线性模型，以帮助它忽略不太有用的特征。

这种方法的一种变体是在原始数据集的每个变换上拟合不同的模型，并使用集成模型来组合来自每个模型的预测。

这种通用方法的一个好处是，它允许模型利用同一原始数据的多个不同视角或视图，这是上面讨论的其他两种方法所缺乏的特性。这可能允许从数据集中挤出额外的预测技能。

这种方法的缺点是增加了计算成本，并且需要仔细选择特征选择技术和/或用于解释如此大量输入特征的模型。

有关这种数据准备方法的更多信息，请参见教程:

*   [如何利用表格数据的特征提取进行机器学习](https://machinelearningmastery.com/feature-extraction-on-tabular-data/)

## 进一步阅读

如果您想更深入地了解这个主题，本节将提供更多资源。

### 相关教程

*   [什么是机器学习项目中的数据准备](https://machinelearningmastery.com/what-is-data-preparation-in-machine-learning/)
*   [如何网格搜索数据准备技术](https://machinelearningmastery.com/grid-search-data-preparation-techniques/)
*   [如何利用表格数据的特征提取进行机器学习](https://machinelearningmastery.com/feature-extraction-on-tabular-data/)

### 书

*   [特征工程与选择](https://amzn.to/3aydNGf)，2019。
*   [机器学习的特征工程](https://amzn.to/2XZJNR2)，2018。

## 摘要

在本教程中，您发现了可用于为预测建模数据集选择数据准备技术的策略。

具体来说，您了解到:

*   可以根据数据集和算法的详细知识来选择数据准备技术，这是最常见的方法。
*   数据准备技术可以作为建模管道中的另一个超参数进行网格搜索。
*   数据转换可以并行应用于训练数据集，以创建许多提取的特征，在这些特征上可以应用特征选择并训练模型。

**你有什么问题吗？**
在下面的评论中提问，我会尽力回答。*