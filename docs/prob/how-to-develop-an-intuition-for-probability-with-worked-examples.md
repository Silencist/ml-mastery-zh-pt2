# 如何通过工作实例开发概率的直觉

> 原文：<https://machinelearningmastery.com/how-to-develop-an-intuition-for-probability-with-worked-examples/>

最后更新于 2020 年 12 月 21 日

令人沮丧的是，概率计算是不直观的。

我们的大脑太急于走捷径，得到错误的答案，而不是思考一个问题，正确计算概率。

为了使这个问题变得明显并有助于发展直觉，从应用概率的角度解决经典问题可能是有用的。这些问题，如生日问题、男孩或女孩问题和蒙蒂霍尔问题，用不正确的直观答案欺骗了我们，需要仔细应用边际、条件和联合概率的规则，才能得出正确的答案。

在这篇文章中，你将发现如何通过解决经典的发人深省的问题来培养对概率的直觉。

看完这篇文章，你会知道:

*   如何用概率相乘来解决生日问题？
*   如何用条件概率解决男孩或女孩问题？
*   如何用联合概率求解蒙蒂霍尔问题？

**用我的新书[机器学习概率](https://machinelearningmastery.com/probability-for-machine-learning/)启动你的项目**，包括*分步教程*和所有示例的 *Python 源代码*文件。

我们开始吧。

*   **2020 年 12 月更新**:改写了男孩女孩悖论条件概率示例，使其更加清晰。

![How to Develop an Intuition for Probability With Worked Examples](img/c3b5f75860ef85d55ab4160f0ae3d71c.png)

如何通过工作实例培养对概率的直觉
图片由[伯纳·萨沃里奥](https://www.flickr.com/photos/44073224@N04/42800604665/)提供，保留部分权利。

## 概观

本教程分为三个部分；它们是:

1.  生日问题
2.  男孩还是女孩的问题
3.  蒙蒂霍尔问题

## 生日问题

应用概率的一个经典例子是计算两个人生日相同的概率。

这是一个经典的例子，因为结果与我们的直觉不符。因此，它有时被称为[生日悖论](https://en.wikipedia.org/wiki/Birthday_problem)。

这个问题可以概括为:

> **问题** : *需要多少人才能让组内任意两人生日相同，且至少有 50-50 的几率？*

这个问题没有什么诀窍；它包括简单地计算边缘概率。

假设随机选择的人在一年中任何给定的一天(不包括闰年)过生日的概率在一年中的各天均匀分布，例如 1/365 或大约 0.273%。

我们的直觉可能会跳跃到一个答案，并假设我们可能至少需要和一年中的天数一样多的人，例如 365 人。我们的直觉可能会失灵，因为我们在考虑自己和其他人是否与自己的生日相匹配。也就是说，我们在想，和你同一天出生的另一个人需要多少人。这是一个不同的问题。

相反，为了计算解决方案，我们可以考虑比较一个群体中的几对人，以及给定的一对人在同一天出生的概率。这将解锁所需的计算。

一个组内成对比较的次数(不包括每个人与他们自己的比较)计算如下:

*   比较= n *(n–1)/2

例如，如果我们有一个五人小组，我们将在小组中进行 10 次成对比较，以检查他们是否有相同的生日，这比我们预期的更有可能成功。重要的是，组内比较的次数随着组的大小呈指数增长。

还需要一步。计算问题的逆更容易。即一组中两个人生日不相同的概率。然后，我们可以反转最终结果，以给出所需的概率，例如:

*   p(n 人中有 2 人生日相同)= 1–p(n 人中有 2 人生日不同)

我们可以通过一个小群体的例子来了解为什么计算不匹配生日的概率很容易，在这个例子中，有三个人。

可以一个一个地将人添加到组中。每次将一个人添加到组中，它都会减少一年中没有生日的可用天数，从而将可用天数减少一天。例如 365 天、364 天等。

此外，添加到组中的给定附加人员不匹配的概率必须与之前计算的概率相结合。例如 P(n=2) * P(n=3)等。

这给出了以下结果，计算组大小为 3 的生日不匹配的概率:

*   P(n=3) = 365/365 * 364/365 * 363/365
*   P(n=3) = 99.18%

反转这个给出了三个人中大约 0.820%的匹配生日。

通过这一步，第一个人有一个生日，这将组中其他人的候选天数从 365 天减少到 364 天(即没有生日的天数)。对于第二个人，我们将冲突生日的概率从一年中的 365 天计算为 364 个安全日，或者大约(364/365) 99.72%的概率没有相同的生日。我们现在从可用天数中减去第二个人的生日，得到 363 天。第三个人没有匹配生日的概率然后被给出为 363/365 乘以先验概率，给出大约 99.18%

对于大型组来说，这种计算可能会很繁琐，因此我们可能希望将其自动化。

下面的例子计算了从 2 到 30 的组大小的概率。

```py
# example of the birthday problem
# define group size
n = 30
# number of days in the year
days = 365
# calculate probability for different group sizes
p = 1.0
for i in range(1, n):
	av = days - i
	p *= av / days
	print('n=%d, %d/%d, p=%.3f 1-p=%.3f' % (i+1, av, days, p*100, (1-p)*100))
```

运行该示例首先打印组大小，然后是可用天数除以一年中的总天数，然后是组中没有匹配生日的概率，接着是补码或组中两个人过生日的概率。

```py
n=2, 364/365, p=99.726 1-p=0.274
n=3, 363/365, p=99.180 1-p=0.820
n=4, 362/365, p=98.364 1-p=1.636
n=5, 361/365, p=97.286 1-p=2.714
n=6, 360/365, p=95.954 1-p=4.046
n=7, 359/365, p=94.376 1-p=5.624
n=8, 358/365, p=92.566 1-p=7.434
n=9, 357/365, p=90.538 1-p=9.462
n=10, 356/365, p=88.305 1-p=11.695
n=11, 355/365, p=85.886 1-p=14.114
n=12, 354/365, p=83.298 1-p=16.702
n=13, 353/365, p=80.559 1-p=19.441
n=14, 352/365, p=77.690 1-p=22.310
n=15, 351/365, p=74.710 1-p=25.290
n=16, 350/365, p=71.640 1-p=28.360
n=17, 349/365, p=68.499 1-p=31.501
n=18, 348/365, p=65.309 1-p=34.691
n=19, 347/365, p=62.088 1-p=37.912
n=20, 346/365, p=58.856 1-p=41.144
n=21, 345/365, p=55.631 1-p=44.369
n=22, 344/365, p=52.430 1-p=47.570
n=23, 343/365, p=49.270 1-p=50.730
n=24, 342/365, p=46.166 1-p=53.834
n=25, 341/365, p=43.130 1-p=56.870
n=26, 340/365, p=40.176 1-p=59.824
n=27, 339/365, p=37.314 1-p=62.686
n=28, 338/365, p=34.554 1-p=65.446
n=29, 337/365, p=31.903 1-p=68.097
n=30, 336/365, p=29.368 1-p=70.632
```

结果令人惊讶，显示只有 23 个人被要求在同一天给两个人超过 50%的机会过生日。

更令人惊讶的是，有 30 个人，这增加到 70%的概率。这很令人惊讶，因为 20 到 30 人大约是学校的平均班级规模，我们对这些人都有一种直觉(如果我们上过学)。

如果群体规模增加到 60 人左右，那么群体中两个人生日相同的概率在 99%以上！

## 男孩还是女孩的问题

应用概率的另一个经典例子是计算婴儿是男孩还是女孩的概率。

在没有额外信息的情况下，给定婴儿是男孩还是女孩的概率为 50%。这在现实中可能是真的，也可能不是真的，但让我们假设这是对概率的有用说明。

一旦包含更多的信息，概率计算就会改变，这甚至会让精通数学和概率的人出错。

一个流行的例子是所谓的“两个孩子的问题”，涉及到获得一个有两个孩子的家庭的信息，并估计一个孩子的性别。如果问题表述不准确，会导致误解，进而导致两种不同的概率计算方式。这是使用自然语言代替符号的挑战，在这种情况下被称为“[男孩或女孩悖论](https://en.wikipedia.org/wiki/Boy_or_Girl_paradox)”

让我们看两个精确陈述的例子。

> **案例 1** : *一个女人有两个孩子，最大的是个男孩。这个女人生两个儿子的概率有多大？*

考虑一张无条件概率表。

```py
Younger Child | Older Child | Unconditional Probability
Girl            Boy           1/4
Boy             Boy           1/4
Girl            Girl          1/4
Boy             Girl          1/4
```

我们的直觉表明，另一个孩子是男孩的概率是 0.5%或 50%。

或者，我们的直觉可能会暗示，对于一个两个孩子的家庭，男孩和女孩的四种可能组合，一个有两个男孩的家庭的概率是 1/4(例如，概率为 0.25)。

我们可以通过列举包含给定信息的所有可能组合来探索这一点:

```py
Younger Child | Older Child | Conditional Probability
Girl            Boy           1/2
Boy             Boy           1/2 (*)
Girl            Girl          0 (impossible)
Boy             Girl          0 (impossible)
```

直觉告诉我们，额外的信息使某些情况变得不可能。

会有四种结果，但给出的信息将范围缩小到两种可能的结果(较大的孩子是男孩)。

事实上，两种结果中只有一种可以是男孩-男孩，因此概率为 1/2 或(0.5) 50%。

让我们看看第二个非常相似的例子。

> **案例二** : *一个女人有两个孩子，其中一个是男孩。这个女人生两个儿子的概率有多大？*

我们的直觉跳跃到同样的结论。至少我的是这样。

**这是不正确的。**

例如，1/2 为男孩，第二个孩子为男孩。在所有可能有两个孩子的情况中，男孩男孩的情况可能会有 1/4 的飞跃。

为了找出原因，让我们再次列举所有可能的组合:

```py
Younger Child | Older Child | Conditional Probability
Girl            Boy           1/3
Boy             Boy           1/3 (*)
Boy             Girl          1/3
Girl            Girl          0 (impossible)
```

同样，直觉告诉我们，额外的信息使得某些情况变得不可能。

会有四种结果，但给出的信息将范围缩小到三种可能的结果(一个孩子是男孩)。三种情况中有一种是男孩-男孩，因此概率为 1/3 或约 33.33%。

我们在案例 1 中有更多的信息，这使我们能够缩小可能结果的范围，并给出符合我们直觉的结果。

案例 2 看起来很相似，但实际上包含的信息较少。我们不知道大一点的孩子还是小一点的孩子是男孩，因此可能的结果范围更大，导致答案不直观。

我们也可以通过计算条件概率来解决这个问题。

在**案例 1** 中，我们可以将问题表述为:假设已知最大的孩子是男孩，那么一个随机家庭有两个男孩(例如男孩-男孩的序列)的概率是多少。

给定一个事件存在另一个事件的概率称为[条件概率](https://machinelearningmastery.com/joint-marginal-and-conditional-probability-for-machine-learning/)，可以使用以下公式计算:

*   P(给定的 B) = P(A 和 B) / P(B)

在这里，我们可以把事件 A 看作“2 个男孩”，事件 B 看作“最大的是个男孩”。

*   A =“两个男孩”
*   B =“最大的是个男孩”

然后，我们可以使用我们的术语重申条件概率的计算:

*   P(“2 个男孩”给出“最大的是男孩”)= P(“2 个男孩”和“最大的是男孩”)/ P(“最大的是男孩”)

根据家庭中出生的一系列孩子的具体结果来看待这些事件是有帮助的。

例如，事件可以按照男孩和女孩的顺序来定义，如下所示:

*   “两个男孩”包括{男孩-男孩}
*   “最大的是男孩”包括{男孩-男孩，女孩-男孩}

鉴于给定的信息，即最大的孩子是男孩，事件{女孩-女孩}和{男孩-女孩}是不可能的。

这样来看我们事件的定义，可以看到条件概率计算的分子 P(“2 个男孩”和“最大的是男孩”)包含一些冗余。具体来说，事件“2 个男孩”是事件“最大的是男孩”的子集。

这是条件概率中的一种特殊情况，例如，当事件 A 是事件 B 的子集时，P(A 和 B)

在这种特殊情况下，P(A 和 B)可以简化为 P(A)。

*   P(A 和 B) = P(A)，如果事件 A 是事件 B 的子集

这可能会让初学者感到困惑，但我们经常说，如果 A 是 B 的子集，那么 A 意味着 B 的出现，也就是说，如果 A 出现，B 是确定的，或者概率为 1.0。

*   P(A 和 B) = (A * B) = (A * 1.0)

因此，我们可以将分子简化为“2 个男孩”的概率:

*   P(“2 个男孩”和“最大的是男孩”)= P(“2 个男孩”)

我们现在可以使用这种简化来重申条件概率的计算:

*   P(“2 个男孩”给出“最大的是男孩”)= P(“2 个男孩”)/ P(“最大的是男孩”)

我们可以从上面的无条件概率表中得到我们所知道的，并替换这些项。

例如，“2 个男孩”(例如“男孩-男孩”)的概率是 1/4。“最大的是男孩”的概率是“男孩-男孩”的概率是 1/4 加上“女孩-男孩”的概率也是 1/4 等于 2/4。

*   p("两个男孩")= 1/4
*   p(“最大的是男孩”)= (1/4 + 1/4) = 2/4 = 1/2

因此:

*   P(“2 个男孩”给出“最大的是男孩”)= P(“2 个男孩”)/ P(“最大的是男孩”)
*   p(“2 个男孩”给出“最大的是男孩”)= (1/4) / (1/2)
*   p(“2 个男孩”给出“最大的是男孩”)= 1/2

或者用数字代替分数:

*   P(“2 个男孩”给出“最大的是男孩”)= P(“2 个男孩”)/ P(“最大的是男孩”)
*   p(“2 个男孩”给出“最大的是男孩”)= 0.25 / 0.5
*   p(“2 个男孩”给出“最大的是男孩”)= 0.5

在**案例 2** 中，我们可以把问题表述为:一个随机家庭有两个男孩，已知其中一个孩子是男孩的概率是多少。

再次计算条件概率是:

*   P(给定的 B) = P(A 和 B) / P(B)

在这里，我们可以将事件 A 视为“2 个男孩”，将事件 B 视为“至少 1 个男孩”:

*   A =“两个男孩”
*   B =“至少一个男孩”

然后，我们可以使用我们的术语重申条件概率的计算:

*   P("2 个男孩"被给予"至少 1 个男孩")= P("2 个男孩"和"至少 1 个男孩")/ P("至少 1 个男孩")

我们可以在这个计算中看到一些冗余，特别是分子 P(“2 个男孩”和“至少 1 个男孩”)。

事件“至少 1 个男孩”比“2 个男孩”更一般，或者换句话说，“2 个男孩”是事件“至少 1 个男孩”的子集。

*   “两个男孩”包括{男孩-男孩}
*   “至少一个男孩”包括{男孩-男孩、男孩-女孩、女孩-男孩}

给定条件概率规则:

*   P(A 和 B) = P(A)，如果事件 A 是事件 B 的子集

我们可以把分子简化为“2 个男孩”。

*   P("两个男孩"和"至少一个男孩")= P("两个男孩")

现在，我们可以重新计算一下。

*   P("2 个男孩"给定"至少 1 个男孩")= P("2 个男孩")/ P("至少 1 个男孩")

然后，上面的无条件概率表可用于在计算中替换特定值。

例如，“2 个男孩”(例如男孩-男孩)的概率是 1/4。“至少 1 个男孩”的概率是“男孩-男孩”的概率加上“男孩-女孩”的概率加上“女孩-男孩”的概率。

*   p("两个男孩")= 1/4
*   p("至少一个男孩")= (1/4 + 1/4 + 1/4) = 3/4

因此:

*   P("2 个男孩"给定"至少 1 个男孩")= P("2 个男孩")/ P("至少 1 个男孩")
*   p("两个男孩"给出"至少一个男孩")= (1/4) / (3/4)
*   p(“两个男孩”给出“至少一个男孩”)= 1 /3

或者用数字代替分数:

*   P("2 个男孩"给定"至少 1 个男孩")= P("2 个男孩")/ P("至少 1 个男孩")
*   P("2 个男孩"给出"至少 1 个男孩")= 0.25 / 0.75
*   p(“2 个男孩”给出“至少 1 个男孩”)= 0.333

注意，[概率第 96 页提供了这个计算的一个版本:给热情的初学者](https://amzn.to/2jULJsu)。

这是一个有用的例子，说明我们如何通过列举可能的情况来克服不正确的直觉并获得正确的答案，以及我们如何通过计算条件概率来获得相同的结果。

## 蒙蒂霍尔问题

应用概率中的最后一个经典问题叫做游戏展示问题，或称[蒙蒂霍尔问题](https://en.wikipedia.org/wiki/Monty_Hall_problem)。

它基于一个名为“*让我们做个交易*”的真实游戏节目，并以该节目主持人的名字命名。

这个问题可以概括描述如下:

> **问题** : *给选手三个门的选择。一辆后面是汽车，另外两辆后面是山羊。一旦选择了一扇门，知道汽车在哪里的主人就会打开另一扇门，里面有一只山羊，并询问参赛者是否希望保留他们的选择或换到另一扇未打开的门。*

这是另一个经典问题，因为解决方案不直观，在过去引起了很大的混乱和争论。

对问题的直觉告诉我们，最初有 1/3 或 33%的几率会选车，一旦主人打开车门露出一只山羊，这个几率就变成了 1/2 或 50%。

**这是不正确的。**

我们可以从列举所有组合和列出无条件概率开始。假设有三扇门，用户随机选择一扇门，例如门 1。

```py
Door 1 | Door 2 | Door 3 | Unconditional Probability
Goat     Goat     Car      1/3
Goat     Car      Goat     1/3
Car      Goat     Goat     1/3
```

在这个阶段，有 1/3 的概率有车，匹配我们到目前为止的直觉。

然后，主人用一只山羊打开另一扇门，在本例中是第二扇门。

打开的门不是随机选择的；相反，它是用汽车不在哪里的信息选择的。

我们的直觉建议我们从表中删除第二种情况，并将剩余情况的概率更新为 1/2。

**这是不正确的，也是错误的原因。**

我们可以将这个场景的直观条件概率总结如下:

```py
Door 1 | Door 2 | Door 3 | Uncon. | Cond.
Goat     Goat     Car      1/3      1/2
Goat     Car      Goat     1/3      0
Car      Goat     Goat     1/3      1/2
```

如果参赛者在主持人开门之前没有做出选择，例如主持人开门是独立的，那么这是正确的。

诀窍来了，因为选手在主持人开门前做了选择，这是有用的信息。这意味着主人不能打开选择的门(门 1)或打开后面有车的门。主持人的选择取决于参赛者的第一选择，然后受到约束。

相反，无论主机打开哪扇门，我们都必须计算切换或不切换的概率。

让我们看一张结果表，给出选择 1 号门和停留或转换。

```py
Door 1 | Door 2 | Door 3 | Stay | Switch
Goat     Goat     Car      Goat   Car
Goat     Car      Goat     Goat   Car
Car      Goat     Goat     Car    Goat
```

我们可以看到 2/3 的切换情况会导致赢得一辆车(前两排)，如果我们留下来，1/3 会给车(最后一排)。

如果选手换车，则有 2/3 或 66.66%的概率获胜。

**他们应该一直切换。**

我们已经通过列举和计算解决了这个问题。

解决这个问题的另一种方法是计算主机开门的联合概率，以测试两种情况下的停留与切换决策，从而最大化期望结果的概率。

例如，假设参赛者选择了门 1，如果门 1 有车，我们可以计算主人打开门 3 的概率如下:

*   p(车门 1 =汽车，车门 3 =打开)= 1/3 * 1/2
*   = 0.333 * 0.5
*   = 0.166

然后，我们可以计算车门 2 让汽车和主机打开车门 3 的联合概率。这是不同的，因为如果门 2 包含汽车，主机只能打开门 3；它有 1.0 的概率，一个确定性。

*   p(车门 2 =汽车，车门 3 =打开)= 1/3 * 1
*   = 0.333 * 1.0
*   = 0.333

选择了门 1 和主机打开门 3 后，汽车在门 2 后面的概率(约 33%)高于门 1(约 16%)。我们应该换一下。

在这种情况下，我们应该切换到 2 号门。

或者，我们可以模拟主机打开门 2 的选择，它具有相同的概率结构:

*   p(车门 1 =汽车，车门 2 =打开)= 0.166
*   p(车门 3 =汽车，车门 2 =打开)= 0.333

同样，选择门 1 和主机打开门 2 后，汽车在门 3 后面的概率(约 33%)高于门 1(约 16%)。我们应该换一下。

如果我们寻求最大化这些概率，那么最好的策略是转换。

同样，在这个例子中，我们已经看到了如何克服我们错误的直觉，并通过列举案例和使用条件概率来解决问题。

## 进一步阅读

如果您想更深入地了解这个主题，本节将提供更多资源。

### 书

*   [概率:对于热情的初学者](https://amzn.to/2jULJsu)，2016 年。
*   [概率论:科学的逻辑](https://amzn.to/2lnW2pp)，2003。

### 文章

*   [条件概率，维基百科](https://en.wikipedia.org/wiki/Conditional_probability)。
*   [男孩还是女孩悖论，维基百科](https://en.wikipedia.org/wiki/Boy_or_Girl_paradox)。
*   [生日问题，维基百科](https://en.wikipedia.org/wiki/Birthday_problem)。
*   蒙提大厅问题，维基百科。

## 摘要

在这篇文章中，你发现了如何通过解决经典的发人深省的问题来培养对概率的直觉。

具体来说，您了解到:

*   如何用概率相乘来解决生日问题？
*   如何用条件概率解决男孩或女孩问题？
*   如何用联合概率求解蒙蒂霍尔问题？

你有什么问题吗？
在下面的评论中提问，我会尽力回答。